(this["webpackJsonptrivia-test"]=this["webpackJsonptrivia-test"]||[]).push([[0],{26:function(e,t,a){e.exports=a.p+"static/media/trivia.466d153e.png"},32:function(e,t,a){e.exports=a(51)},44:function(e,t){},49:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(18),c=a.n(s),o=a(7),i=a(30),l=a(45),u=a(2),m=a.n(u),p=a(11),d=a(19),v=a(5),f=a(6),b=a(9),g=a(8),h=a(25),E=a.n(h),w=function(){var e=Object(p.a)(m.a.mark((function e(){var t,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://opentdb.com/api_token.php?command=request");case 3:return t=e.sent,a=t.json(),e.abrupt("return",a);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(p.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://opentdb.com/api.php?amount=5&token=".concat(t));case 3:return a=e.sent,n=a.json(),e.abrupt("return",n);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();var y=function(e){return{type:"SAVE_TOKEN",payload:e}},N=a(26),S=a.n(N),_=function(e){Object(b.a)(a,e);var t=Object(g.a)(a);function a(){var e;return Object(v.a)(this,a),(e=t.call(this)).checkInput=function(){var t=e.state,a=t.playerName,n=t.gravatarEmail;a.length>0&&n.length>0?e.setState({isBtnDisabled:!1}):e.setState({isBtnDisabled:!0})},e.handleChange=function(t){var a=t.target,n=a.name,r=a.value;e.setState(Object(d.a)({},n,r),e.checkInput)},e.saveTokenLocalStorage=function(){var t=e.props.token;localStorage.setItem("token",t)},e.handleLogin=function(){var t=Object(p.a)(m.a.mark((function t(a){var n,r,s,c,o,i,l,u,p;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),n=e.state,r=n.playerName,s=n.gravatarEmail,c=E()(s).toString(),console.log(c),o=e.props,i=o.saveTokenProp,l=o.saveNameProp,u=o.saveEmailProp,t.next=7,w();case 7:return p=t.sent,t.next=10,i(p.token);case 10:e.saveTokenLocalStorage(),l(r),u(c),e.setState({isLogged:!0});case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.state={playerName:"",gravatarEmail:"",isBtnDisabled:!0,isLogged:!1},e}return Object(f.a)(a,[{key:"render",value:function(){var e=this.state,t=e.playerName,a=e.gravatarEmail,n=e.isBtnDisabled;return e.isLogged?r.a.createElement(l.Redirect,{to:"/game"}):r.a.createElement("main",{className:"login_page"},r.a.createElement("img",{className:"logo_img",src:S.a,alt:"trivia"}),r.a.createElement("form",{className:"login_form",onSubmit:this.handleLogin,action:""},r.a.createElement("input",{className:"login_input","data-testid":"input-player-name",name:"playerName",type:"text",placeholder:"Nome",value:t,onChange:this.handleChange}),r.a.createElement("input",{className:"login_input",name:"gravatarEmail","data-testid":"input-gravatar-email",type:"email",placeholder:"E-mail Gravatar",value:a,onChange:this.handleChange}),r.a.createElement("button",{className:"play_btn",disabled:n,name:"btnPlay","data-testid":"btn-play",type:"submit"},"Jogar!")))}}]),a}(n.Component),O=Object(o.b)((function(e){return{token:e.token,name:e.name,gravatarEmail:e.gravatarEmail}}),(function(e){return{saveTokenProp:function(t){return e(y(t))},saveNameProp:function(t){return e({type:"SAVE_USER_NAME",payload:t})},saveEmailProp:function(t){return e({type:"SAVE_USER_EMAIL",payload:t})}}}))(_),j=a(31),A=a(3),x=function(e){return e.map((function(e){var t=e.question,a=e.correct_answer,n=e.incorrect_answers,r=t.replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&eacute;/,"\xe9"),s=a.replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&eacute;/,"\xe9"),c=n.map((function(e){return e.replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&eacute;/,"\xe9")}));return Object(A.a)(Object(A.a)({},e),{},{question:r,correct_answer:s,incorrect_answers:c})}))},C=(a(49),function(e){Object(b.a)(a,e);var t=Object(g.a)(a);function a(){return Object(v.a)(this,a),t.apply(this,arguments)}return Object(f.a)(a,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.email,n=e.score;return r.a.createElement("div",{className:"header_div"},r.a.createElement("img",{className:"header_img",src:"https://www.gravatar.com/avatar/".concat(a),alt:"Gravatar Profile","data-testid":"header-profile-picture"}),r.a.createElement("h2",{className:"player_name","data-testid":"header-player-name"}," Player: ".concat(t)),r.a.createElement("h2",{className:"player_score","data-testid":"header-score"},"Score: ".concat(n)))}}]),a}(n.Component));var R=Object(o.b)((function(e){var t=e.player;return{name:t.name,email:t.email,score:t.score}}))(C),q=function(e){Object(b.a)(a,e);var t=Object(g.a)(a);function a(){var e;return Object(v.a)(this,a),(e=t.call(this)).setTimer=function(){e.intervalId=setInterval((function(){e.state.counter<=0?(clearInterval(e.intervalId),e.setState({counter:0})):e.setState((function(e){return{counter:e.counter-1}}))}),1e3)},e.sortAnswers=function(t){var a=t.map((function(e){var t=e.correct_answer,a=e.incorrect_answers;return[t].concat(Object(j.a)(a)).sort((function(){return Math.random()-.5}))}));e.setState({sortedAnswers:a})},e.getNewToken=Object(p.a)(m.a.mark((function t(){var a,n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.saveTokenProp,t.next=3,w();case 3:n=t.sent,localStorage.setItem("token",n.token),a(n.token),e.getQuestions();case 7:case"end":return t.stop()}}),t)}))),e.getQuestions=Object(p.a)(m.a.mark((function t(){var a,n,r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=localStorage.getItem("token"),t.next=3,k(a);case 3:3===(n=t.sent).response_code?e.getNewToken():(r=x(n.results),e.setState({questions:r,loading:!1},e.sortAnswers(r)));case 5:case"end":return t.stop()}}),t)}))),e.saveRanking=function(t){var a=e.props,n=a.name,r=a.score,s=a.email,c=a.saveUserScoreProp,o=r+t,i={name:n,score:o,picture:"https://www.gravatar.com/avatar/".concat(s)};c(o),localStorage.setItem("ranking",JSON.stringify(i)),e.saveAssertions()},e.saveAssertions=function(){var t=e.props;(0,t.saveUserAssertionsProp)(t.assertions+1)},e.calculateTotal=function(t){var a=e.state.counter,n=0;switch(t){case"easy":n=1;break;case"medium":n=2;break;case"hard":n=3}var r=10+a*n;e.saveRanking(r)},e.selectAnswer=function(t,a){e.setState({correctAnswerClassName:"correct-answer",wrongAnswerClassName:"wrong-answers",nextQuestion:!0},clearInterval(e.intervalId)),t&&e.calculateTotal(a)},e.switchQuestion=function(){var t=e.state.questionNumber;t<4?e.setState({wrongAnswerClassName:"",correctAnswerClassName:"",questionNumber:t+=1,counter:30,nextQuestion:!1},e.setTimer):e.setState({feedback:!0})},e.state={questions:[],questionNumber:0,sortedAnswers:[],loading:!0,wrongAnswerClassName:"",correctAnswerClassName:"",counter:30,nextQuestion:!1,feedback:!1},e}return Object(f.a)(a,[{key:"componentDidMount",value:function(){this.getQuestions(),this.setTimer()}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"render",value:function(){var e=this,t=this.state,a=t.questions,n=t.questionNumber,s=t.loading,c=t.correctAnswerClassName,o=t.wrongAnswerClassName,i=t.sortedAnswers,u=t.counter,m=t.nextQuestion,p=t.feedback;if(s)return r.a.createElement("h1",null,"loading...");if(p)return r.a.createElement(l.Redirect,{to:"/feedback"});var d=a[n],v=d.category,f=d.correct_answer,b=d.question,g=d.difficulty;return r.a.createElement(r.a.Fragment,null,r.a.createElement(R,null),r.a.createElement("main",{className:"game_page"},r.a.createElement("span",{className:"game_timer"},u),r.a.createElement("section",{className:"question_section"},r.a.createElement("h3",{className:"question_title","data-testid":"question-category"},v),r.a.createElement("p",{className:"question"},b)),r.a.createElement("section",{className:"answer_section","data-testid":"answer-options"},i[n].map((function(t,a){return t===f?r.a.createElement("button",{key:t,type:"button",className:"answer_btn ".concat(c),"data-testid":"correct-answer",onClick:function(){return e.selectAnswer(!0,g)},disabled:0===u},t):r.a.createElement("button",{key:t,type:"button","data-testid":"wrong-answer-".concat(a),className:"answer_btn ".concat(o),onClick:function(){return e.selectAnswer(!1)},disabled:0===u},t)}))),r.a.createElement("section",{className:"next_section"},(m||0===u)&&r.a.createElement("button",{className:"next_btn",type:"button","data-testid":"btn-next",onClick:this.switchQuestion},"Next"))))}}]),a}(r.a.Component),I=Object(o.b)((function(e){var t=e.token,a=e.player;return{token:t,name:a.name,score:a.score,email:a.email,picture:a.score,assertions:a.assertions}}),(function(e){return{saveTokenProp:function(t){return e(y(t))},saveUserScoreProp:function(t){return e(function(e){return{type:"SAVE_USER_SCORE",payload:{score:e}}}(t))},saveUserAssertionsProp:function(t){return e(function(e){return{type:"SAVE_USER_ASSERTIONS",payload:{assertions:e}}}(t))}}}))(q),T=function(e){Object(b.a)(a,e);var t=Object(g.a)(a);function a(){return Object(v.a)(this,a),t.apply(this,arguments)}return Object(f.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",{"data-testid":"settings-title"},"Settings"))}}]),a}(n.Component),P=function(e){Object(b.a)(a,e);var t=Object(g.a)(a);function a(){var e;return Object(v.a)(this,a),(e=t.call(this)).state={isRedirected:!1},e}return Object(f.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.assertions,n=t.score;return this.state.isRedirected?r.a.createElement(l.Redirect,{to:"/"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(R,null),r.a.createElement("main",{className:"feedback_page"},r.a.createElement("section",{className:"score_section"},r.a.createElement("h3",{className:"assertions","data-testid":"feedback-total-question"},"Assertions: ".concat(a)),r.a.createElement("h3",{className:"total_score","data-testid":"feedback-total-score"},"Score: ".concat(n))),r.a.createElement("section",{className:"feedback_section"},r.a.createElement("h1",{className:"feedback_title","data-testid":"feedback-text"},"Feedback"),a<3?r.a.createElement("span",{className:"feedback_text","data-testid":"feedback-text"},"Could be better..."):r.a.createElement("span",{className:"feedback_text","data-testid":"feedback-text"},"Well Done!"),r.a.createElement("button",{className:"playAgain_btn",type:"button","data-testid":"btn-play-again",onClick:function(){return e.setState({isRedirected:!0})}},"Play Again"))))}}]),a}(r.a.Component),U=Object(o.b)((function(e){var t=e.player;return{assertions:t.assertions,score:t.score}}))(P);a(50);function V(){return r.a.createElement(l.Switch,null,r.a.createElement(l.Route,{exact:!0,path:"/",component:O}),r.a.createElement(l.Route,{path:"/game",component:I}),r.a.createElement(l.Route,{path:"/settings",component:T}),r.a.createElement(l.Route,{path:"/feedback",component:U}))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var L=a(15),Q=a(29),D=a(28),B={name:"",assertions:0,score:0,gravatarEmail:""};var M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"SAVE_USER_NAME":return Object(A.a)(Object(A.a)({},e),{},{name:n});case"SAVE_USER_ASSERTIONS":return Object(A.a)(Object(A.a)({},e),{},{assertions:n.assertions});case"SAVE_USER_SCORE":return Object(A.a)(Object(A.a)({},e),{},{score:n.score});case"SAVE_USER_EMAIL":return Object(A.a)(Object(A.a)({},e),{},{email:n});default:return e}};var W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"SAVE_TOKEN":return n;default:return e}},J=Object(L.combineReducers)({player:M,token:W}),F=Object(L.createStore)(J,Object(D.composeWithDevTools)(Object(L.applyMiddleware)(Q.a)));window.Cypress&&(window.store=F);var G=F;c.a.render(r.a.createElement(i.BrowserRouter,null,r.a.createElement(o.a,{store:G},r.a.createElement(V,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[32,1,2]]]);
//# sourceMappingURL=main.235a2f3f.chunk.js.map